# 设计模式开篇

### 如何评价代码质量的高低？

#### 1. 可维护性（maintainability）

在不破坏原有代码设计、不引人新的 bug 的情况下，能够快速地修改或者添加代码。

代码分层清晰、模块化好、高内聚低耦合，遵从基于接口而非实现编程的设计原则等等。如果 bug 容易修复，修改、添加新功能能够轻松完成，就可以主观地认为代码是易维护的。

#### 2. 可读性（readability）

代码是否符合编码规范、命名是否达意、注释是否详尽、函数是否长短合适、模块划分是否清晰、是否符合高内聚低耦合等等。

#### 3. 可扩展性（extendsibility）

在不修改或少量修改原有代码的情况下，通过扩展的方式添加新功能代码。

#### 4. 灵活性（flexibility）

* 当添加一个新的功能代码的时候，原有代码已经预留了扩展点，不需要修改原有代码，只要在扩展点上添加代码即可。
* 实现一个功能，原代码已经抽象了很多可以复用的模块、类代码等，可以直接拿来用。

#### 5. 简洁性（simplicity）

KISS 原则："Keep It Simple, Stupid"，即尽量保持代码简单。

**思从深而行从简，真正的高手能云淡风轻地用最简单的方法解决最复杂的问题。**

#### 6. 可复用性（reusability）

DRY(Don't Repeat Yourself)

#### 7. 可测试性（testability）

代码可测试性强。

### 面向对象、设计原则、设计模式、编程规范、重构

![design1](media/16367841388006/design1.png)

### 什么是面向对象编程和面向对象编程语言

面向对象编程（OOP），面向对象编程语言(OOPL)。

面向对象编程两个基础的概念：类（class）和对象（object）。

> 面向对象编程是一种编程范式或编程风格，它以类或对象作为组织代码的基本单元，并将封装、抽象、继承、多态四个特性作为代码设计和实现的基石。

#### 封装（Encapsulation）

类通过暴露有限的访问接口，授权外部仅能通过类提供的方式(或者叫函数)来访问内部信息或者数据，即**访问控制权限**。

类仅仅通过有限的方法暴露必要的操作，能提高类的易用性，调用者不必关系背后的业务细节，用错的概率会减少很多。

#### 抽象（Abstraction）

抽象隐藏方法的具体实现，提供了哪些功能，不需要知道这些功能是如何实现的，比如 Java 中的 interface 或 abstract。

抽象作为一种只关注功能点不关注实现的设计思路，可以帮我们过滤掉许多非必要的信息。

#### 继承（Inheritance）

继承是用来表示类之间的 is-a 关系，继承可以分为单继承和多继承。

继承的最大好处就是代码复用， 不过过度继承，继承层次过深过复杂，就会导致代码可读性可维护性变差。

#### 多态（Polymorphism）

多态是指子类可以替换父类，在实际代码运行过程中，调用子类的方法实现。

多态特性能提高代码的可扩展性和复用性，对于不同的集合类型，可以传递给相同的函数。

### 哪些代码设计看似面向对象，实际是面向过程的？

#### 1. 滥用 getter、setter 方法

面向对象封装的定义是：通过访问权限控制，隐藏内部数据，外部仅能通过类提供有限的接口访问、修改内部数据。所有，暴露不应该暴露的 setter 方法，明显违反了面向对象的封装特性。

在设计实现类的时候，除非真的需要，否则尽量不要给属性定义 setter 方法。此外，返回集合容器也要防范集合内部数据被修改的危险。

#### 2. 滥用全局变量和全局方法

常见的全局变量有单例类对象、静态成员变量、常量等，常见的全局方法有静态方法。

**常见的 Constants 类定义**

```Java

public class Constants {
  public static final String MYSQL_ADDR_KEY = "mysql_addr";
  public static final String MYSQL_DB_NAME_KEY = "db_name";
  public static final String MYSQL_USERNAME_KEY = "mysql_username";
  public static final String MYSQL_PASSWORD_KEY = "mysql_password";
  
  public static final String REDIS_DEFAULT_ADDR = "192.168.7.2:7234";
  public static final int REDIS_DEFAULT_MAX_TOTAL = 50;
  public static final int REDIS_DEFAULT_MAX_IDLE = 50;
  public static final int REDIS_DEFAULT_MIN_IDLE = 20;
  public static final String REDIS_DEFAULT_KEY_PREFIX = "rt:";
  
  // ... 省略更多的常量定义...
}
```



